<!-- giftable here really is only ever an invitation. -->
<div id="gift-card-modal" class="modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Gift Cards:<%= @giftable.person.full_name %></h3>
        <h5>All Time Total: <span id='gift_card_total'><%= @giftable.person.gift_card_total %></span>
      </div>
      <div class="modal-body">
        <div id="error-div"></div>
        <%= form_for( @gift_card, remote: true) do |form| %>
          <% if @gift_card.errors.any? %>
            <div id="error_explanation">
              <h2><%= pluralize(@gift_card.errors.count, "error") %> prohibited this gift_card from being saved:</h2>

              <ul>
              <% @gift_card.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
              </ul>
            </div>
          <% end %>
          <%= form.hidden_field :person_id, :value => @giftable.person_id %>
          <%= form.hidden_field :giftable_id, :value => @giftable.id %>
          <%= form.hidden_field :giftable_type, :value => @giftable.class.to_s %>
          <%= form.select :reason,
                  GiftCard.reasons.keys.to_a,
                  { prompt: "Reason", selected: 'interview' },
                    class: 'input-small',
                    id: "new-reason"
                   %>

          <%= form.text_field :proxy_id,
                  placeholder: "ProxyID",
                  class: 'input-mini',
                  id: "new-proxyid" %>
          <%= form.text_field :batch_id,
                  placeholder: "BatchID",
                  class: 'input-mini',
                  id: "new-batchid",
                  value: @last_gift_card.batch_id %>
          <%= form.text_field :expiration_date,
                  placeholder: "MM/YY",
                  class: 'input-mini',
                  id: "new-expirationdate",
                  value: @last_gift_card.expiration_date %>
          <%= form.text_field :amount,
                  value: @last_gift_card.amount,
                  placeholder: "####",
                  class: 'input-mini',
                  id: "new-amount" %>
          <%= form.submit 'Add Gift Card', :class => "btn btn-small" %>
        <% end %>
        <%= render partial: 'gift_cards/mini_view',
              locals: { gift_cards: @giftable.gift_cards } %>
      </div> <!-- modal body end -->
      <div class="modal-footer"><a href="#" class="btn">Close</a></div>
    </div>
  </div>
</div>
