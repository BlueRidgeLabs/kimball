<div class="row">
  <div class="span6">
    <%= form_for @submission do |f| %>
      <fieldset>
        <legend>Submission <%= @submission.id %>:
          <% if @submission.person.present? %>
            <%= link_to @submission.person.full_name, @submission.person %>
           %>
        </legend>
        <% if @submission.errors.any? %>
          <div id="error_explanation" class="alert alert-error">
            <ul>
            <% @submission.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
            </ul>
          </div>
        <% end %>
        <%= f.label "Person ID (Number)" %>
        <%= f.text_field :person_id, class: 'span2' %>

        <%= f.label :form_type %>
        <%= f.select(:form_type, Submission.form_types.keys.map {|form_type| [form_type.titleize,form_type]}) %>

        <div class="form-actions">
          <%= f.submit 'Save', class: "btn btn-primary" %>
          <%= link_to 'Cancel', :back, class: "btn" %>
          <%= link_to 'Delete',
                url_for(action: :destroy, id: @submission.id),
                class: "btn btn-danger",
                method: :delete,
                data: {confirm: "Are you sure?"}  %>
        </div>

      </fieldset>
    <% end %>
  </div>
  <div class="span6">
      <% if @submission.person.present? %>
      <% @person = @submission.person %>
      <dl>
          <dt>Phone</dt>
          <dd><%= best_in_place @person, :phone_number, display_with: :number_to_phone %></dd>

          <dt>Email</dt>
          <dd><%= best_in_place @person, :email_address %></dd>

          <dt>Preferred Contact Method</dt>

          <dd><%= best_in_place @person, :preferred_contact_method, as: :select, collection: [['SMS','SMS'], ['EMAIL','EMAIL']] %></dd>
          <dt>Voted in last election?</dt>
          <dd><%= best_in_place @person, :voted, as: :select, :collection => %w(YES NO) %></dd>

          <dt>Ever called 311?</dt>
          <dd><%= best_in_place @person, :called_311, as: :select, :collection => %w(YES NO) %></dd>

          <dt>Facebook</dt>
          <dd>link to facebook</dd>

          <dt>Twitter</dt>
          <dd>link to twitter</dd>

          <dt>Signup at</dt>
          <dd><%= @person.signup_at ? @person.signup_at.to_s(:long) : 'unknown' %></dd>
        </dl>
      <legend>Add Tags for <%= link_to @submission.person.full_name, @submission.person %></legend>
        <ul id="tag-list">
        <%= render partial: 'taggings/tagging', collection: @submission.person.taggings %>
        </ul>
        <%= render partial: 'taggings/tag_form', locals: {taggable_obj: @submission.person}%>
    <% end %>
  </div>
</div>

