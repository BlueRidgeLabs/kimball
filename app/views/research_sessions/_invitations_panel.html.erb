<table class="table table-hover invitees" id='dynamic-invitation-panel' >
  <tbody>
    <tr>
      <th>Remove</th>
      <th>Name</th>
      <th>Action</th>
      <th>Current State</th>
      <th>Gift Card #</th>
      <th>Add Cards</th>
    </tr>
    <% for invitation in @research_session.invitations.includes(:person) do %>
      <tr> <% person = Person.find(invitation.person_id) %>
        <td><%= link_to "X", 
                  research_session_remove_person_path(@research_session, person), 
                  remote: true, 
                  class: 'btn btn-danger btn-mini' %> </td>
        <td><%= link_to person.full_name, 
                person_path(person), 
                id: "person-#{person.id}" %></td>
        <td>
          <%= render partial: 'invitations/actions', locals: {invitation: invitation} %>
        </td>
        <td><%= invitation.aasm_state %></td>
        <td id="<%= invitation.id %>-gift-card-count">
          <%= invitation.gift_cards.size %>
        </td>
        <td>
        <%= link_to "+",
              modal_gift_cards_path(invitation.class.to_s, invitation.id),
                {:remote => true,
                  'data-toggle' =>  "modal",
                  'data-target' => '#modal-window',
                  class: 'btn btn-mini'} unless invitation.missed? %>
        </td>
      </tr>
    <% end if @research_session.invitations.size > 0 %>
  </tbody>
</table>
<div id="modal-window" class="modal hide" role="dialog" aria-labelledby="GiftCardModal" aria-hidden="true"></div>
